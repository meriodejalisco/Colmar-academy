if (self.CavalryLogger) { CavalryLogger.start_js(["tbpl5"]); }

__d("UFIReactionsAnimationPreloader",["csx","Promise","Bootloader","Deferred","Event","Parent","Run","SubscriptionsHandler","UFIReactionsKeyframesAssets","UFIReactionTypes","emptyFunction"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=new(c("SubscriptionsHandler"))(),j=null,k=null,l=false,m=false,n=new(c("Deferred"))(),o=null;function p(){if(o)return c("Promise").resolve(o);return n.then(function(){return new(c("Promise"))(function(x){return c("Bootloader").loadModules(["Keyframes"],function(y){o=y;x(y)},"UFIReactionsAnimationPreloader")})})}function q(){__p&&__p();if(k){k.remove();k=null}if(j){j.remove();j=null}if(!m)n=new(c("Deferred"))();i.release();i.engage()}function r(x,y){__p&&__p();return p().then(function(z){__p&&__p();var A=[];for(var B=Object.entries(c("UFIReactionsKeyframesAssets").reactions_newschema),C=Array.isArray(B),D=0,B=C?B:B[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var E;if(C){if(D>=B.length)break;E=B[D++]}else{D=B.next();if(D.done)break;E=D.value}var F=E,G=F[0],H=F[1];if(x.indexOf(Number(G))!==-1&&typeof H==="string"){var I={projectName:"feedback_reactions",assetName:c("UFIReactionTypes").reactions[G].name};A.push(y?z.requestRenderer(H,I):z.requestDecodedAssetOnly(H,I))}}return c("Promise").all(A)}).then(c("emptyFunction"))}function s(){return p().then(function(x){return x.preloadPackage(c("UFIReactionsKeyframesAssets")["package"].uri,{projectName:"feedback_reactions",packageName:c("UFIReactionsKeyframesAssets")["package"].name})})}function t(){m=true;q()}function u(){l=false}function v(){if(!l&&!j)j=c("Run").onAfterLoad(function(){n.resolve()});if(!k)k=c("Run").onLeave(function(){if(!m)q()})}function w(){this.$UFIReactionsAnimationPreloader1=false;this.$UFIReactionsAnimationPreloader2=false;v()}w.prototype.alsoBootloadKeyframes=function(x){this.$UFIReactionsAnimationPreloader1=x;return this};w.prototype.usePackage=function(x){this.$UFIReactionsAnimationPreloader2=x;return this};w.prototype.load=function(x){if(!l){l=true;this.$UFIReactionsAnimationPreloader3(x).done(t,u)}};w.prototype.$UFIReactionsAnimationPreloader3=function(x){if(this.$UFIReactionsAnimationPreloader2){var y=x.filter(function(z){return c("UFIReactionsKeyframesAssets")["package"].ids[z]==null});return c("Promise").all([s(),r(y,this.$UFIReactionsAnimationPreloader1)]).then(c("emptyFunction"))}return r(x,this.$UFIReactionsAnimationPreloader1)};w.prototype.registerMouseTrigger=function(x,y){if(!m){var z=c("Parent").bySelector(x,".commentable_item");if(z){var event=c("Event").listen(z,"mousemove",function(){this.load(y)}.bind(this));i.addSubscriptions(event)}}};f.exports=w}),null);